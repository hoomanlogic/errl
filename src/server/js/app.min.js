var app=app||{};if(function(e,r){"use strict";e.HOST_NAME=window.location.href.split("/").slice(0,3).join("/"),errl.config={developer:"hoomanlogic",key:"54263eb4-6ced-49bf-9bd7-14f0106c2a02",product:"Errl",environment:null,version:"1.0.2",getState:null,getUser:function(){return"geoffrey.floyd"},onLogged:function(e){toastr.error('<p><string>Oops!</strong></p><p>We\'re really sorry about that.</p><p>We\'ll get this fixed as soon as possible.</p><a class="btn btn-default btn-link" target="_blank" href="'+errl.getErrorDetailUrl(e.errorId)+'">Show me details</a> ')}},e.setAccessToken=function(e){sessionStorage.setItem("accessToken",e)},e.getAccessToken=function(){return sessionStorage.getItem("accessToken")},e.hideCriteria=function(){r("#criteria").removeClass("expanded"),r("#view").removeClass("with-criteria")},e.showCriteria=function(){r("#criteria").addClass("expanded"),r("#view").addClass("with-criteria")}}(app,$),window.onerror=function(){errl.log(arguments)},!app.getAccessToken()){var fragment=hl.common.getFragment();fragment.access_token?(window.location.hash=fragment.state||"",app.setAccessToken(fragment.access_token)):window.location="/Account/Authorize?client_id=web&response_type=token&state="+encodeURIComponent(window.location.hash)}window.onmousemove=function(e){e.y>50&&e.x<20&&!$("#criteria").hasClass("expanded")?app.showCriteria():e.y>50&&e.x>420&&$("#criteria").hasClass("expanded")&&app.hideCriteria()};var ContentEditable=React.createClass({displayName:"ContentEditable",render:function(){return React.createElement("div",{style:{display:"inline"},onInput:this.emitChange,onBlur:this.emitChange,contentEditable:!0,dangerouslySetInnerHTML:{__html:this.props.html}})},shouldComponentUpdate:function(e){return e.html!==this.props.html},emitChange:function(){var e=this.getDOMNode().innerHTML;this.props.onChange&&e!==this.lastHtml&&this.props.onChange({target:{value:e}}),this.lastHtml=e}}),DataTable=React.createClass({displayName:"DataTable",getInitialState:function(){return{sortBy:this.props.sortBy||this.props.columnDefinitions[0].field,sortAsc:void 0!==this.props.sortAsc?this.props.sortAsc:!0}},getDefaultProps:function(){return{maxColWidth:"30vw"}},componentDidUpdate:function(){$('[data-toggle="tooltip"]').tooltip()},render:function(){var e=this.state.sortBy,r=this.state.sortAsc,t=this.props.columnDefinitions,o=_.sortBy(this.props.data,function(r){return r[e]});if(r!==!0&&o.reverse(),!t)return null;var i,a,u=[],s=[];for(i=0;i<t.length;i++){var h=React.createElement("th",{className:"text-"+(t[i].justify||"left")},React.createElement("a",{href:"javascript:;",onClick:this.sort.bind(null,t[i].field)},t[i].display," ",React.createElement("i",{className:e===t[i].field?r?"fa fa-sort-asc":"fa fa-sort-desc":""})));u.push(h)}if(o)for(a=0;a<o.length;a++){var n=[];for(i=0;i<t.length;i++){var l=null,d=o[a][t[i].field];t[i].limitLength&&d.length>t[i].limitLength&&(d=d.slice(0,t[i].limitLength)),l=t[i].onRender?t[i].onRender(o[a],t[i].field,a):t[i].onCellClick?React.createElement("a",{href:"javascript:;",onClick:t[i].onCellClick.bind(null,t[i].field,o[a])},React.createElement("span",{"data-toggle":"tooltip","data-placement":"bottom",title:o[a][t[i].field]},d)):React.createElement("span",{"data-toggle":"tooltip","data-placement":"bottom",title:o[a][t[i].field]},d);var c=React.createElement("td",{className:"text-"+(t[i].justify||"left"),style:{overflowWrap:"break-word",maxWidth:t[i].maxWidth||this.props.maxColWidth}},l);n.push(c)}var y=React.createElement("tr",null,n);s.push(y)}return React.createElement("table",{className:"table table-striped"},React.createElement("thead",null,React.createElement("tr",null,u)),React.createElement("tbody",null,s))},sort:function(e){var r=this.state.sortBy,t=this.state.sortAsc;e===r?t=!t:(r=e,t=!0),this.setState({sortBy:r,sortAsc:t})}}),DropdownMenu=React.createClass({displayName:"DropdownMenu",getDefaultProps:function(){return{className:"",style:null,buttonContent:null,menuItems:[],open:!1}},render:function(){var e=this.props.className,r=this.props.buttonContent,t=this.props.style,o=this.props.menuItems;return e.length>0&&(e=" "+e),this.props.useDiv&&this.props.useDiv===!0?React.createElement("div",{ref:"dropdown",className:"dropdown"+e,onClick:this.toggle},React.createElement("a",{href:"#","data-toggle":"dropdown",className:"dropdown-toggle",style:t},r),React.createElement("ul",{className:"dropdown-menu"},o)):React.createElement("li",{ref:"dropdown",className:"dropdown"+e,onClick:this.toggle},React.createElement("a",{href:"#","data-toggle":"dropdown",className:"dropdown-toggle",style:t},r),React.createElement("ul",{className:"dropdown-menu"},o))},toggle:function(){var e=$(window),r=$(this.refs.dropdown.getDOMNode()),t=function(o){0!=r.has(o.target).length||r.is(o.target)||(r.removeClass("open"),e.off("click.Bst",t))};r.toggleClass("open"),e.on("click.Bst",t)}}),Modal=React.createClass({displayName:"Modal",getBuffer:function(){var e=2*$(".modal-dialog").offset().top;return e>60&&(e=60),e+=$(".modal-header").innerHeight(),e+=$(".modal-footer").innerHeight()},getDefaultProps:function(){return{backdrop:!0,buttons:[],keyboard:!0,show:!0,remote:"",overflowX:"none",overflowY:"scroll"}},render:function(){var e=this.props.buttons.map(function(e,r){return React.createElement("button",{key:r,type:"button",className:"btn btn-"+e.type,onClick:e.handler},e.text)});return React.createElement("div",{className:"modal fade"},React.createElement("div",{className:"modal-dialog",style:{maxWidth:"95vw"}},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},this.renderCloseButton(),React.createElement("strong",null,this.props.header)),React.createElement("div",{className:"modal-body scroll",style:{height:$(window).innerHeight()-174+"px",overflowX:this.props.overflowX,overflowY:this.props.overflowY}},this.props.children),React.createElement("div",{className:"modal-footer"},e))))},renderCloseButton:function(){return React.createElement("button",{type:"button",className:"close",onClick:this.hide,dangerouslySetInnerHTML:{__html:"&times"}})},hide:function(){var e=$(this.getDOMNode());e.removeClass("in"),window.setTimeout(function(){e.css("display","none")}.bind(this),150),$(window).unbind("resize",this.resizeModal)},show:function(){var e=$(this.getDOMNode());e.css("display","block"),window.setTimeout(function(){e.addClass("in")}.bind(this),1),$(window).bind("resize",this.resizeModal)},resizeModal:function(){$(".modal-body").css("height",$(window).innerHeight()-this.getBuffer()+"px")}}),Panel=React.createClass({displayName:"Panel",getDefaultProps:function(){return{header:null,type:"default"}},componentDidMount:function(){this.rememberHeight()},componentDidUpdate:function(){this.rememberHeight()},render:function(){var e=this.props.children,r=this.props.type,t=this.props.header;return React.createElement("div",{className:"panel panel-"+r},React.createElement("div",{className:"panel-heading clickable",onClick:this.toggle},React.createElement("h4",{className:"panel-title overflow"},t)),React.createElement("div",{ref:"collapsible",className:"panel-collapse collapse"},e))},rememberHeight:function(){var e=$(this.refs.collapsible.getDOMNode());this.props.height=e.height()},toggle:function(){var e=$(this.refs.collapsible.getDOMNode());e.hasClass("collapsing")||(e.hasClass("in")?(e.css("height",this.props.height+"px").removeClass("collapse in").addClass("collapsing").attr("aria-expanded",!1).height(0).css("height","0"),window.setTimeout(function(){e.removeClass("collapsing").addClass("collapse")},350)):(e.css("height","0").removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).height(0).css("height",this.props.height+"px"),window.setTimeout(function(){e.removeClass("collapsing").addClass("collapse in").height("").css("height",null)},350)))}}),ErrorHistoryModal=React.createClass({displayName:"ErrorHistoryModal",getInitialState:function(){return{details:null,info:null}},render:function(){var e=null;return this.state.info&&(e=this.state.info.map(function(e){return React.createElement("li",null,e)})),React.createElement(Modal,{ref:"modal",show:!1,header:"Error History",overflowX:"scroll"},React.createElement("div",null,React.createElement("ul",{id:"modalStatsInfo"},e),React.createElement(DataTable,{sortBy:"occurred",sortAsc:!1,data:this.state.details,columnDefinitions:[{field:"errorType",display:"Type"},{field:"errorDescription",display:"Description"},{field:"objectName",display:"Object"},{field:"subName",display:"Sub"},{field:"stackTrace",display:"Stack Trace",onRender:this.renderStackTrace},{field:"state",display:"State",onRender:this.renderJsonTree},{field:"details",display:"Details",onRender:this.renderJsonTree},{field:"userId",display:"User"},{field:"occurred",display:"Occurred",justify:"right",onRender:this.renderDate}]})))},renderStackTrace:function(e){var r=/\((.*?):(\d+):(\d+)\)/;return e.stackTrace.split(" at ").slice(1).map(function(e){console.log(e);var t=r.exec(e);if(null!=t){var o=e.replace(t[0],"").trim();return React.createElement("div",null,React.createElement("a",{target:"_blank",href:t[1]},React.createElement("span",{"data-toggle":"tooltip","data-placement":"right",title:t[0]},o)))}return React.createElement("div",null,e)})},renderJsonTree:function(e,r){return e[r].split(",").map(function(e){return React.createElement("div",null,e)})},renderDate:function(e,r){var t=new Date(e[r]).toLocaleDateString()+" "+new Date(e[r]).toTimeString().split(" ")[0];return t.split(" ").map(function(e){return React.createElement("div",null,e)})},handleClose:function(){this.refs.modal.hide()},open:function(e){this.setState({details:e.details,info:e.info}),this.refs.modal.show()}}),ReportsPage=React.createClass({displayName:"ReportsPage",getInitialState:function(){return{options:null,criteria_report:"Recent Versions Comparison",criteria_product:null,criteria_environment:null,reportData:null}},componentDidMount:function(){this.getReportOptions()},canvasNeedsRender:!1,componentDidUpdate:function(){this.canvasNeedsRender&&(this.canvasNeedsRender=!1,this.renderReport())},render:function(){var e=this.state.options,r=this.state.reportData;if(null===e)return null;var t=this.getReports(e).map(function(e){return React.createElement("option",{value:e},e)}),o=this.getProducts(e).map(function(e){return React.createElement("option",{value:e},e)}),i=this.getEnvironments(e,this.state.criteria_product).map(function(e){return React.createElement("option",{value:e},e)}),a=[];return r&&(a.push(React.createElement("div",null,React.createElement("h3",{id:"headingChart"},"Version Comparison Error Occurrences"),React.createElement("hr",null),React.createElement("div",{id:"myLineChartContainer"},React.createElement("canvas",{id:"myLineChart",width:"970",height:"400"})),React.createElement("div",{id:"myLineChartLegend"}))),a.push(React.createElement("div",null,React.createElement("h3",{id:"headingChart2"},"Version Comparison Users Affected"),React.createElement("hr",null),React.createElement("div",{id:"myLineChartContainer2"},React.createElement("canvas",{id:"myLineChart2",width:"970",height:"400"})),React.createElement("div",{id:"myLineChartLegend2"}))),a.push(React.createElement("div",null,React.createElement("h3",{id:"headingChart3"},"Version Comparison Types of Errors"),React.createElement("hr",null),React.createElement("div",{id:"myLineChartContainer3"},React.createElement("canvas",{id:"myLineChart3",width:"970",height:"400"})),React.createElement("div",{id:"myLineChartLegend3"})))),React.createElement("div",{className:"row"},React.createElement("div",{id:"criteria",className:"expanded"},React.createElement("form",{className:"form-horizontal",role:"form"},React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectReport",className:"col-sm-4 control-label"},"Report"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectReport",className:"form-control",value:this.state.criteria_report,onChange:this.handleCriteriaChange},t))),React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectProduct",className:"col-sm-4 control-label"},"Product"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectProduct",className:"form-control",value:this.state.criteria_product,onChange:this.handleCriteriaChange},o))),React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectEnvironment",className:"col-sm-4 control-label"},"Environment"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectEnvironment",className:"form-control",value:this.state.criteria_environment,onChange:this.handleCriteriaChange},i))))),React.createElement("div",{id:"view",className:"with-criteria"},a))},openErrorHistory:function(e,r){"errorType"===e?this.popupErrorDetails(r.errorType,"",""):"objectName"===e?this.popupErrorDetails("",r.objectName,""):this.popupErrorDetails("",r.objectName,r.subName)},handleCriteriaChange:function(e){var r={reportData:null};"selectReport"===e.target.id?r.criteria_report=e.target.value:"selectProduct"===e.target.id?(r.criteria_product=e.target.value,r.criteria_environment=this.getEnvironments(this.state.options,r.criteria_product)[0]):"selectEnvironment"===e.target.id&&(r.criteria_environment=e.target.value),this.getReportData(r.criteria_report||this.state.criteria_report,r.criteria_product||this.state.criteria_product,r.criteria_environment||this.state.criteria_environment),this.setState(r)},getReportData:function(e,r,t){$.ajax({context:this,type:"GET",headers:{Authorization:"Bearer "+app.getAccessToken()},url:app.HOST_NAME+"/api/reports?report="+encodeURIComponent(e)+"&product="+encodeURIComponent(r)+"&environment="+encodeURIComponent(t)}).done(function(e){this.canvasNeedsRender=!0,this.setState({reportData:e})}).fail(function(e,r){toastr.error(e.responseText||r,"System Error")})},renderReport:function(){var e=this.state.reportData;this.createChart1(e),this.createChart2(e),this.createChart3(e)},divideIfNotByZero:function(e,r){return 0===e||0===r?0:e/r},createChart1:function(e){var r=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],t=[],o=[],i=[],a=[];t.push(this.divideIfNotByZero(e.query2[0].hour00,e.query5[0].hour00)),t.push(this.divideIfNotByZero(e.query2[0].hour01,e.query5[0].hour01)),t.push(this.divideIfNotByZero(e.query2[0].hour02,e.query5[0].hour02)),t.push(this.divideIfNotByZero(e.query2[0].hour03,e.query5[0].hour03)),t.push(this.divideIfNotByZero(e.query2[0].hour04,e.query5[0].hour04)),t.push(this.divideIfNotByZero(e.query2[0].hour05,e.query5[0].hour05)),t.push(this.divideIfNotByZero(e.query2[0].hour06,e.query5[0].hour06)),t.push(this.divideIfNotByZero(e.query2[0].hour07,e.query5[0].hour07)),t.push(this.divideIfNotByZero(e.query2[0].hour08,e.query5[0].hour08)),t.push(this.divideIfNotByZero(e.query2[0].hour09,e.query5[0].hour09)),t.push(this.divideIfNotByZero(e.query2[0].hour10,e.query5[0].hour10)),t.push(this.divideIfNotByZero(e.query2[0].hour11,e.query5[0].hour11)),t.push(this.divideIfNotByZero(e.query2[0].hour12,e.query5[0].hour12)),t.push(this.divideIfNotByZero(e.query2[0].hour13,e.query5[0].hour13)),t.push(this.divideIfNotByZero(e.query2[0].hour14,e.query5[0].hour14)),t.push(this.divideIfNotByZero(e.query2[0].hour15,e.query5[0].hour15)),t.push(this.divideIfNotByZero(e.query2[0].hour16,e.query5[0].hour16)),t.push(this.divideIfNotByZero(e.query2[0].hour17,e.query5[0].hour17)),t.push(this.divideIfNotByZero(e.query2[0].hour18,e.query5[0].hour18)),t.push(this.divideIfNotByZero(e.query2[0].hour19,e.query5[0].hour19)),t.push(this.divideIfNotByZero(e.query2[0].hour20,e.query5[0].hour20)),t.push(this.divideIfNotByZero(e.query2[0].hour21,e.query5[0].hour21)),t.push(this.divideIfNotByZero(e.query2[0].hour22,e.query5[0].hour22)),t.push(this.divideIfNotByZero(e.query2[0].hour23,e.query5[0].hour23)),t.push(this.divideIfNotByZero(e.query2[0].hour24,e.query5[0].hour24)),a.push({label:e.query2[0].version,fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:t}),e.query2.length>1&&(o.push(this.divideIfNotByZero(e.query2[1].hour00,e.query5[1].hour00)),o.push(this.divideIfNotByZero(e.query2[1].hour01,e.query5[1].hour01)),o.push(this.divideIfNotByZero(e.query2[1].hour02,e.query5[1].hour02)),o.push(this.divideIfNotByZero(e.query2[1].hour03,e.query5[1].hour03)),o.push(this.divideIfNotByZero(e.query2[1].hour04,e.query5[1].hour04)),o.push(this.divideIfNotByZero(e.query2[1].hour05,e.query5[1].hour05)),o.push(this.divideIfNotByZero(e.query2[1].hour06,e.query5[1].hour06)),o.push(this.divideIfNotByZero(e.query2[1].hour07,e.query5[1].hour07)),o.push(this.divideIfNotByZero(e.query2[1].hour08,e.query5[1].hour08)),o.push(this.divideIfNotByZero(e.query2[1].hour09,e.query5[1].hour09)),o.push(this.divideIfNotByZero(e.query2[1].hour10,e.query5[1].hour10)),o.push(this.divideIfNotByZero(e.query2[1].hour11,e.query5[1].hour11)),o.push(this.divideIfNotByZero(e.query2[1].hour12,e.query5[1].hour12)),o.push(this.divideIfNotByZero(e.query2[1].hour13,e.query5[1].hour13)),o.push(this.divideIfNotByZero(e.query2[1].hour14,e.query5[1].hour14)),o.push(this.divideIfNotByZero(e.query2[1].hour15,e.query5[1].hour15)),o.push(this.divideIfNotByZero(e.query2[1].hour16,e.query5[1].hour16)),o.push(this.divideIfNotByZero(e.query2[1].hour17,e.query5[1].hour17)),o.push(this.divideIfNotByZero(e.query2[1].hour18,e.query5[1].hour18)),o.push(this.divideIfNotByZero(e.query2[1].hour19,e.query5[1].hour19)),o.push(this.divideIfNotByZero(e.query2[1].hour20,e.query5[1].hour20)),o.push(this.divideIfNotByZero(e.query2[1].hour21,e.query5[1].hour21)),o.push(this.divideIfNotByZero(e.query2[1].hour22,e.query5[1].hour22)),o.push(this.divideIfNotByZero(e.query2[1].hour23,e.query5[1].hour23)),o.push(this.divideIfNotByZero(e.query2[1].hour24,e.query5[1].hour24)),a.push({label:e.query2[1].version,fillColor:"rgba(151,205,187,0.2)",strokeColor:"rgba(151,205,187,1)",pointColor:"rgba(151,205,187,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,205,187,1)",data:o})),e.query2.length>2&&(i.push(this.divideIfNotByZero(e.query2[2].hour00,e.query5[2].hour00)),i.push(this.divideIfNotByZero(e.query2[2].hour01,e.query5[2].hour01)),i.push(this.divideIfNotByZero(e.query2[2].hour02,e.query5[2].hour02)),i.push(this.divideIfNotByZero(e.query2[2].hour03,e.query5[2].hour03)),i.push(this.divideIfNotByZero(e.query2[2].hour04,e.query5[2].hour04)),i.push(this.divideIfNotByZero(e.query2[2].hour05,e.query5[2].hour05)),i.push(this.divideIfNotByZero(e.query2[2].hour06,e.query5[2].hour06)),i.push(this.divideIfNotByZero(e.query2[2].hour07,e.query5[2].hour07)),i.push(this.divideIfNotByZero(e.query2[2].hour08,e.query5[2].hour08)),i.push(this.divideIfNotByZero(e.query2[2].hour09,e.query5[2].hour09)),i.push(this.divideIfNotByZero(e.query2[2].hour10,e.query5[2].hour10)),i.push(this.divideIfNotByZero(e.query2[2].hour11,e.query5[2].hour11)),i.push(this.divideIfNotByZero(e.query2[2].hour12,e.query5[2].hour12)),i.push(this.divideIfNotByZero(e.query2[2].hour13,e.query5[2].hour13)),i.push(this.divideIfNotByZero(e.query2[2].hour14,e.query5[2].hour14)),i.push(this.divideIfNotByZero(e.query2[2].hour15,e.query5[2].hour15)),i.push(this.divideIfNotByZero(e.query2[2].hour16,e.query5[2].hour16)),i.push(this.divideIfNotByZero(e.query2[2].hour17,e.query5[2].hour17)),i.push(this.divideIfNotByZero(e.query2[2].hour18,e.query5[2].hour18)),i.push(this.divideIfNotByZero(e.query2[2].hour19,e.query5[2].hour19)),i.push(this.divideIfNotByZero(e.query2[2].hour20,e.query5[2].hour20)),i.push(this.divideIfNotByZero(e.query2[2].hour21,e.query5[2].hour21)),i.push(this.divideIfNotByZero(e.query2[2].hour22,e.query5[2].hour22)),i.push(this.divideIfNotByZero(e.query2[2].hour23,e.query5[2].hour23)),i.push(this.divideIfNotByZero(e.query2[2].hour24,e.query5[2].hour24)),a.push({label:e.query2[2].version,fillColor:"rgba(200,200,200,0.2)",strokeColor:"rgba(200,200,200,1)",pointColor:"rgba(200,200,200,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(200,200,200,1)",data:i}));var u={labels:r,datasets:a};$("#myLineChart").remove(),$("#myLineChartContainer").append('<canvas id="myLineChart" height="400" width="979"><canvas>');var s=$("#myLineChart").get(0).getContext("2d"),h=new Chart(s).Line(u,{legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="badge" style="margin-right: 5px; background-color:<%=datasets[i].strokeColor%>">•</span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'});$("#myLineChartLegend").empty(),$("#myLineChartLegend").append(h.generateLegend())},createChart2:function(e){var r=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],t=[],o=[],i=[],a=[];t.push(this.divideIfNotByZero(e.query3[0].hour00,e.query5[0].hour00)),t.push(this.divideIfNotByZero(e.query3[0].hour01,e.query5[0].hour01)),t.push(this.divideIfNotByZero(e.query3[0].hour02,e.query5[0].hour02)),t.push(this.divideIfNotByZero(e.query3[0].hour03,e.query5[0].hour03)),t.push(this.divideIfNotByZero(e.query3[0].hour04,e.query5[0].hour04)),t.push(this.divideIfNotByZero(e.query3[0].hour05,e.query5[0].hour05)),t.push(this.divideIfNotByZero(e.query3[0].hour06,e.query5[0].hour06)),t.push(this.divideIfNotByZero(e.query3[0].hour07,e.query5[0].hour07)),t.push(this.divideIfNotByZero(e.query3[0].hour08,e.query5[0].hour08)),t.push(this.divideIfNotByZero(e.query3[0].hour09,e.query5[0].hour09)),t.push(this.divideIfNotByZero(e.query3[0].hour10,e.query5[0].hour10)),t.push(this.divideIfNotByZero(e.query3[0].hour11,e.query5[0].hour11)),t.push(this.divideIfNotByZero(e.query3[0].hour12,e.query5[0].hour12)),t.push(this.divideIfNotByZero(e.query3[0].hour13,e.query5[0].hour13)),t.push(this.divideIfNotByZero(e.query3[0].hour14,e.query5[0].hour14)),t.push(this.divideIfNotByZero(e.query3[0].hour15,e.query5[0].hour15)),t.push(this.divideIfNotByZero(e.query3[0].hour16,e.query5[0].hour16)),t.push(this.divideIfNotByZero(e.query3[0].hour17,e.query5[0].hour17)),t.push(this.divideIfNotByZero(e.query3[0].hour18,e.query5[0].hour18)),t.push(this.divideIfNotByZero(e.query3[0].hour19,e.query5[0].hour19)),t.push(this.divideIfNotByZero(e.query3[0].hour20,e.query5[0].hour20)),t.push(this.divideIfNotByZero(e.query3[0].hour21,e.query5[0].hour21)),t.push(this.divideIfNotByZero(e.query3[0].hour22,e.query5[0].hour22)),t.push(this.divideIfNotByZero(e.query3[0].hour23,e.query5[0].hour23)),t.push(this.divideIfNotByZero(e.query3[0].hour24,e.query5[0].hour24)),a.push({label:e.query3[0].version,fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:t}),e.query2.length>1&&(o.push(this.divideIfNotByZero(e.query3[1].hour00,e.query5[1].hour00)),o.push(this.divideIfNotByZero(e.query3[1].hour01,e.query5[1].hour01)),o.push(this.divideIfNotByZero(e.query3[1].hour02,e.query5[1].hour02)),o.push(this.divideIfNotByZero(e.query3[1].hour03,e.query5[1].hour03)),o.push(this.divideIfNotByZero(e.query3[1].hour04,e.query5[1].hour04)),o.push(this.divideIfNotByZero(e.query3[1].hour05,e.query5[1].hour05)),o.push(this.divideIfNotByZero(e.query3[1].hour06,e.query5[1].hour06)),o.push(this.divideIfNotByZero(e.query3[1].hour07,e.query5[1].hour07)),o.push(this.divideIfNotByZero(e.query3[1].hour08,e.query5[1].hour08)),o.push(this.divideIfNotByZero(e.query3[1].hour09,e.query5[1].hour09)),o.push(this.divideIfNotByZero(e.query3[1].hour10,e.query5[1].hour10)),o.push(this.divideIfNotByZero(e.query3[1].hour11,e.query5[1].hour11)),o.push(this.divideIfNotByZero(e.query3[1].hour12,e.query5[1].hour12)),o.push(this.divideIfNotByZero(e.query3[1].hour13,e.query5[1].hour13)),o.push(this.divideIfNotByZero(e.query3[1].hour14,e.query5[1].hour14)),o.push(this.divideIfNotByZero(e.query3[1].hour15,e.query5[1].hour15)),o.push(this.divideIfNotByZero(e.query3[1].hour16,e.query5[1].hour16)),o.push(this.divideIfNotByZero(e.query3[1].hour17,e.query5[1].hour17)),o.push(this.divideIfNotByZero(e.query3[1].hour18,e.query5[1].hour18)),o.push(this.divideIfNotByZero(e.query3[1].hour19,e.query5[1].hour19)),o.push(this.divideIfNotByZero(e.query3[1].hour20,e.query5[1].hour20)),o.push(this.divideIfNotByZero(e.query3[1].hour21,e.query5[1].hour21)),o.push(this.divideIfNotByZero(e.query3[1].hour22,e.query5[1].hour22)),o.push(this.divideIfNotByZero(e.query3[1].hour23,e.query5[1].hour23)),o.push(this.divideIfNotByZero(e.query3[1].hour24,e.query5[1].hour24)),a.push({label:e.query3[1].version,fillColor:"rgba(151,205,187,0.2)",strokeColor:"rgba(151,205,187,1)",pointColor:"rgba(151,205,187,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,205,187,1)",data:o})),e.query2.length>2&&(i.push(this.divideIfNotByZero(e.query3[2].hour00,e.query5[2].hour00)),i.push(this.divideIfNotByZero(e.query3[2].hour01,e.query5[2].hour01)),i.push(this.divideIfNotByZero(e.query3[2].hour02,e.query5[2].hour02)),i.push(this.divideIfNotByZero(e.query3[2].hour03,e.query5[2].hour03)),i.push(this.divideIfNotByZero(e.query3[2].hour04,e.query5[2].hour04)),i.push(this.divideIfNotByZero(e.query3[2].hour05,e.query5[2].hour05)),i.push(this.divideIfNotByZero(e.query3[2].hour06,e.query5[2].hour06)),i.push(this.divideIfNotByZero(e.query3[2].hour07,e.query5[2].hour07)),i.push(this.divideIfNotByZero(e.query3[2].hour08,e.query5[2].hour08)),i.push(this.divideIfNotByZero(e.query3[2].hour09,e.query5[2].hour09)),i.push(this.divideIfNotByZero(e.query3[2].hour10,e.query5[2].hour10)),i.push(this.divideIfNotByZero(e.query3[2].hour11,e.query5[2].hour11)),i.push(this.divideIfNotByZero(e.query3[2].hour12,e.query5[2].hour12)),i.push(this.divideIfNotByZero(e.query3[2].hour13,e.query5[2].hour13)),i.push(this.divideIfNotByZero(e.query3[2].hour14,e.query5[2].hour14)),i.push(this.divideIfNotByZero(e.query3[2].hour15,e.query5[2].hour15)),i.push(this.divideIfNotByZero(e.query3[2].hour16,e.query5[2].hour16)),i.push(this.divideIfNotByZero(e.query3[2].hour17,e.query5[2].hour17)),i.push(this.divideIfNotByZero(e.query3[2].hour18,e.query5[2].hour18)),i.push(this.divideIfNotByZero(e.query3[2].hour19,e.query5[2].hour19)),i.push(this.divideIfNotByZero(e.query3[2].hour20,e.query5[2].hour20)),i.push(this.divideIfNotByZero(e.query3[2].hour21,e.query5[2].hour21)),i.push(this.divideIfNotByZero(e.query3[2].hour22,e.query5[2].hour22)),i.push(this.divideIfNotByZero(e.query3[2].hour23,e.query5[2].hour23)),i.push(this.divideIfNotByZero(e.query3[2].hour24,e.query5[2].hour24)),a.push({label:e.query3[2].version,fillColor:"rgba(200,200,200,0.2)",strokeColor:"rgba(200,200,200,1)",pointColor:"rgba(200,200,200,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(200,200,200,1)",data:i}));var u={labels:r,datasets:a};$("#myLineChart2").remove(),$("#myLineChartContainer2").append('<canvas id="myLineChart2" height="400" width="979"><canvas>');var s=$("#myLineChart2").get(0).getContext("2d"),h=new Chart(s).Line(u,{legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="badge" style="margin-right: 5px; background-color:<%=datasets[i].strokeColor%>">•</span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'});$("#myLineChartLegend2").empty(),$("#myLineChartLegend2").append(h.generateLegend())},createChart3:function(e){var r=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],t=[],o=[],i=[],a=[];t.push(this.divideIfNotByZero(e.query4[0].hour00,e.query5[0].hour00)),t.push(this.divideIfNotByZero(e.query4[0].hour01,e.query5[0].hour01)),t.push(this.divideIfNotByZero(e.query4[0].hour02,e.query5[0].hour02)),t.push(this.divideIfNotByZero(e.query4[0].hour03,e.query5[0].hour03)),t.push(this.divideIfNotByZero(e.query4[0].hour04,e.query5[0].hour04)),t.push(this.divideIfNotByZero(e.query4[0].hour05,e.query5[0].hour05)),t.push(this.divideIfNotByZero(e.query4[0].hour06,e.query5[0].hour06)),t.push(this.divideIfNotByZero(e.query4[0].hour07,e.query5[0].hour07)),t.push(this.divideIfNotByZero(e.query4[0].hour08,e.query5[0].hour08)),t.push(this.divideIfNotByZero(e.query4[0].hour09,e.query5[0].hour09)),t.push(this.divideIfNotByZero(e.query4[0].hour10,e.query5[0].hour10)),t.push(this.divideIfNotByZero(e.query4[0].hour11,e.query5[0].hour11)),t.push(this.divideIfNotByZero(e.query4[0].hour12,e.query5[0].hour12)),t.push(this.divideIfNotByZero(e.query4[0].hour13,e.query5[0].hour13)),t.push(this.divideIfNotByZero(e.query4[0].hour14,e.query5[0].hour14)),t.push(this.divideIfNotByZero(e.query4[0].hour15,e.query5[0].hour15)),t.push(this.divideIfNotByZero(e.query4[0].hour16,e.query5[0].hour16)),t.push(this.divideIfNotByZero(e.query4[0].hour17,e.query5[0].hour17)),t.push(this.divideIfNotByZero(e.query4[0].hour18,e.query5[0].hour18)),t.push(this.divideIfNotByZero(e.query4[0].hour19,e.query5[0].hour19)),t.push(this.divideIfNotByZero(e.query4[0].hour20,e.query5[0].hour20)),t.push(this.divideIfNotByZero(e.query4[0].hour21,e.query5[0].hour21)),t.push(this.divideIfNotByZero(e.query4[0].hour22,e.query5[0].hour22)),t.push(this.divideIfNotByZero(e.query4[0].hour23,e.query5[0].hour23)),t.push(this.divideIfNotByZero(e.query4[0].hour24,e.query5[0].hour24)),a.push({label:e.query4[0].version,fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:t}),e.query2.length>1&&(o.push(this.divideIfNotByZero(e.query4[1].hour00,e.query5[1].hour00)),o.push(this.divideIfNotByZero(e.query4[1].hour01,e.query5[1].hour01)),o.push(this.divideIfNotByZero(e.query4[1].hour02,e.query5[1].hour02)),o.push(this.divideIfNotByZero(e.query4[1].hour03,e.query5[1].hour03)),o.push(this.divideIfNotByZero(e.query4[1].hour04,e.query5[1].hour04)),o.push(this.divideIfNotByZero(e.query4[1].hour05,e.query5[1].hour05)),o.push(this.divideIfNotByZero(e.query4[1].hour06,e.query5[1].hour06)),o.push(this.divideIfNotByZero(e.query4[1].hour07,e.query5[1].hour07)),o.push(this.divideIfNotByZero(e.query4[1].hour08,e.query5[1].hour08)),o.push(this.divideIfNotByZero(e.query4[1].hour09,e.query5[1].hour09)),o.push(this.divideIfNotByZero(e.query4[1].hour10,e.query5[1].hour10)),o.push(this.divideIfNotByZero(e.query4[1].hour11,e.query5[1].hour11)),o.push(this.divideIfNotByZero(e.query4[1].hour12,e.query5[1].hour12)),o.push(this.divideIfNotByZero(e.query4[1].hour13,e.query5[1].hour13)),o.push(this.divideIfNotByZero(e.query4[1].hour14,e.query5[1].hour14)),o.push(this.divideIfNotByZero(e.query4[1].hour15,e.query5[1].hour15)),o.push(this.divideIfNotByZero(e.query4[1].hour16,e.query5[1].hour16)),o.push(this.divideIfNotByZero(e.query4[1].hour17,e.query5[1].hour17)),o.push(this.divideIfNotByZero(e.query4[1].hour18,e.query5[1].hour18)),o.push(this.divideIfNotByZero(e.query4[1].hour19,e.query5[1].hour19)),o.push(this.divideIfNotByZero(e.query4[1].hour20,e.query5[1].hour20)),o.push(this.divideIfNotByZero(e.query4[1].hour21,e.query5[1].hour21)),o.push(this.divideIfNotByZero(e.query4[1].hour22,e.query5[1].hour22)),o.push(this.divideIfNotByZero(e.query4[1].hour23,e.query5[1].hour23)),o.push(this.divideIfNotByZero(e.query4[1].hour24,e.query5[1].hour24)),a.push({label:e.query4[1].version,fillColor:"rgba(151,205,187,0.2)",strokeColor:"rgba(151,205,187,1)",pointColor:"rgba(151,205,187,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,205,187,1)",data:o})),e.query2.length>2&&(i.push(this.divideIfNotByZero(e.query4[2].hour00,e.query5[2].hour00)),i.push(this.divideIfNotByZero(e.query4[2].hour01,e.query5[2].hour01)),i.push(this.divideIfNotByZero(e.query4[2].hour02,e.query5[2].hour02)),i.push(this.divideIfNotByZero(e.query4[2].hour03,e.query5[2].hour03)),i.push(this.divideIfNotByZero(e.query4[2].hour04,e.query5[2].hour04)),i.push(this.divideIfNotByZero(e.query4[2].hour05,e.query5[2].hour05)),i.push(this.divideIfNotByZero(e.query4[2].hour06,e.query5[2].hour06)),i.push(this.divideIfNotByZero(e.query4[2].hour07,e.query5[2].hour07)),i.push(this.divideIfNotByZero(e.query4[2].hour08,e.query5[2].hour08)),i.push(this.divideIfNotByZero(e.query4[2].hour09,e.query5[2].hour09)),i.push(this.divideIfNotByZero(e.query4[2].hour10,e.query5[2].hour10)),i.push(this.divideIfNotByZero(e.query4[2].hour11,e.query5[2].hour11)),i.push(this.divideIfNotByZero(e.query4[2].hour12,e.query5[2].hour12)),i.push(this.divideIfNotByZero(e.query4[2].hour13,e.query5[2].hour13)),i.push(this.divideIfNotByZero(e.query4[2].hour14,e.query5[2].hour14)),i.push(this.divideIfNotByZero(e.query4[2].hour15,e.query5[2].hour15)),i.push(this.divideIfNotByZero(e.query4[2].hour16,e.query5[2].hour16)),i.push(this.divideIfNotByZero(e.query4[2].hour17,e.query5[2].hour17)),i.push(this.divideIfNotByZero(e.query4[2].hour18,e.query5[2].hour18)),i.push(this.divideIfNotByZero(e.query4[2].hour19,e.query5[2].hour19)),i.push(this.divideIfNotByZero(e.query4[2].hour20,e.query5[2].hour20)),i.push(this.divideIfNotByZero(e.query4[2].hour21,e.query5[2].hour21)),i.push(this.divideIfNotByZero(e.query4[2].hour22,e.query5[2].hour22)),i.push(this.divideIfNotByZero(e.query4[2].hour23,e.query5[2].hour23)),i.push(this.divideIfNotByZero(e.query4[2].hour24,e.query5[2].hour24)),a.push({label:e.query4[2].version,fillColor:"rgba(200,200,200,0.2)",strokeColor:"rgba(200,200,200,1)",pointColor:"rgba(200,200,200,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(200,200,200,1)",data:i}));
var u={labels:r,datasets:a};$("#myLineChart3").remove(),$("#myLineChartContainer3").append('<canvas id="myLineChart3" height="400" width="979"><canvas>');var s=$("#myLineChart3").get(0).getContext("2d"),h=new Chart(s).Line(u,{legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="badge" style="margin-right: 5px; background-color:<%=datasets[i].strokeColor%>">•</span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'});$("#myLineChartLegend3").empty(),$("#myLineChartLegend3").append(h.generateLegend())},getReportOptions:function(){$.ajax({context:this,type:"GET",headers:{Authorization:"Bearer "+app.getAccessToken()},url:app.HOST_NAME+"/api/reportoptions"}).done(function(e){var r=this.state.criteria_report,t=null,o=null;if(e&&e.length>0){var t=this.getProducts(e)[0],o=this.getEnvironments(e,t)[0];this.getReportData(r,t,o)}this.setState({options:e,criteria_product:t,criteria_environment:o})})},getReports:function(){var e=["Recent Versions Comparison"];return e},getProducts:function(e){for(var r=[],t=0;t<e.length;t++)-1===r.indexOf(e[t].product)&&r.push(e[t].product);return r},getEnvironments:function(e,r){for(var t=[],o=0;o<e.length;o++)e[o].product===r&&-1===t.indexOf(e[o].environment)&&t.push(e[o].environment);return t}}),StatusPage=React.createClass({displayName:"StatusPage",getInitialState:function(){return{options:null,criteria_product:null,criteria_environment:null,criteria_version:null,criteria_from:null,criteria_to:null,fromOptions:[],toOptions:[],hourlySummaryResult:null,errorSummaryResult:null}},componentDidMount:function(){this.getOptions(),this.refreshInterval=window.setInterval(this.pollNeedsRefresh,6e4)},componentWillUnmount:function(){window.clearInterval(this.refreshInterval)},hourlySummaryNeedsCanvasRender:!1,errorSummaryNeedsCanvasRender:!1,componentDidUpdate:function(){this.hourlySummaryNeedsCanvasRender&&(this.paintChart_HourlySummary(),this.hourlySummaryNeedsCanvasRender=!1),this.errorSummaryNeedsCanvasRender&&(this.paintChart_ErrorSummary(),this.errorSummaryNeedsCanvasRender=!1)},render:function(){var e=this.state.options,r=this.state.hourlySummaryResult,t=this.state.errorSummaryResult;if(null===e)return null;var o=this.getProducts(e).map(function(e){return React.createElement("option",{value:e},e)}),i=this.getEnvironments(e,this.state.criteria_product).map(function(e){return React.createElement("option",{value:e},e)}),a=this.getVersions(e,this.state.criteria_product,this.state.criteria_environment).map(function(e){return React.createElement("option",{value:e},e)}),u=this.state.fromOptions.map(function(e){return React.createElement("option",{value:e.value},e.label)}),s=this.state.toOptions.map(function(e){return React.createElement("option",{value:e.value},e.label)}),h=null;r&&this.state.toOptions&&this.state.toOptions.length>0&&(h=React.createElement("div",null,React.createElement("h3",{id:"headingHourly"},"Hourly Summary"),React.createElement("hr",null),React.createElement("div",{id:"myLineChartContainer"},React.createElement("canvas",{id:"myLineChart",width:"970",height:"400"})),React.createElement("div",{id:"myLineChartLegend"})));var n=null;return t&&(n=React.createElement("div",{id:"errorSummarySection"},React.createElement("h3",null,"Error Summary"),React.createElement("hr",null),React.createElement("div",{id:"myPieChartContainer"},React.createElement("canvas",{id:"myPieChart",width:"600",height:"300"})),React.createElement("div",{id:"myPieChartLegend"}),React.createElement(DataTable,{sortBy:"latestOccurrence",sortAsc:!1,data:this.state.errorSummaryResult.details,columnDefinitions:[{field:"errorType",display:"Type",onCellClick:this.openErrorHistory},{field:"errorDescription",display:"Description"},{field:"objectName",display:"Object",onCellClick:this.openErrorHistory},{field:"subName",display:"Sub",onCellClick:this.openErrorHistory},{field:"timesOccurred",display:"# Errors"},{field:"latestOccurrence",display:"Latest",justify:"right",onRender:this.renderDate},{field:"usersAffected",display:"Users Affected"}]}))),React.createElement("div",{className:"row"},React.createElement("div",{id:"criteria",className:"expanded"},React.createElement("form",{className:"form-horizontal",role:"form"},React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectProduct",className:"col-sm-4 control-label"},"Product"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectProduct",className:"form-control",value:this.state.criteria_product,onChange:this.handleCriteriaChange},o))),React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectEnvironment",className:"col-sm-4 control-label"},"Environment"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectEnvironment",className:"form-control",value:this.state.criteria_environment,onChange:this.handleCriteriaChange},i))),React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectVersion",className:"col-sm-4 control-label"},"Version"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectVersion",className:"form-control",value:this.state.criteria_version,onChange:this.handleCriteriaChange},a))),React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectFrom",className:"col-sm-4 control-label"},"From"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectFrom",className:"form-control",value:this.state.criteria_from,onChange:this.handleCriteriaChange},u))),React.createElement("div",{className:"form-group"},React.createElement("label",{"for":"selectTo",className:"col-sm-4 control-label"},"To"),React.createElement("div",{className:"col-sm-8"},React.createElement("select",{id:"selectTo",className:"form-control",value:this.state.criteria_to,onChange:this.handleCriteriaChange},s))))),React.createElement("div",{id:"view",className:"with-criteria"},h,n),React.createElement(ErrorHistoryModal,{ref:"errorHistoryModal"}))},renderDate:function(e,r){var t=new Date(e[r]).toLocaleDateString()+" "+new Date(e[r]).toTimeString().split(" ")[0];return t.split(" ").map(function(e){return React.createElement("div",null,e)})},localizeLabel:function(e){var r=new Date(e+":00 GMT-0000");return e=r.toLocaleDateString()+" "+(r.getHours()<10?"0"+r.getHours():r.getHours())},globalizeLabel:function(e){var r=new Date(e+":00");return e=r.toLocaleDateString()+" "+(r.getUTCHours()<10?"0"+r.getUTCHours():r.getUTCHours())},openErrorHistory:function(e,r){"errorType"===e?this.popupErrorDetails(r.errorType,"",""):"objectName"===e?this.popupErrorDetails("",r.objectName,""):this.popupErrorDetails("",r.objectName,r.subName)},handleCriteriaChange:function(e){var r={errorSummaryResult:null},t=!1;"selectProduct"===e.target.id?(t=!0,r.criteria_product=e.target.value,r.criteria_environment=this.getEnvironments(this.state.options,r.criteria_product)[0],r.criteria_version=this.getVersions(this.state.options,r.criteria_product,r.criteria_environment)[0]):"selectEnvironment"===e.target.id?(t=!0,r.criteria_environment=e.target.value,r.criteria_version=this.getVersions(this.state.options,this.state.criteria_product,r.criteria_environment)[0]):"selectVersion"===e.target.id?(t=!0,r.criteria_version=e.target.value):"selectFrom"===e.target.id?(r.criteria_from=parseInt(e.target.value),r.criteria_from>=this.state.criteria_to&&(r.criteria_to=r.criteria_from+1)):"selectTo"===e.target.id&&(r.criteria_to=parseInt(e.target.value),r.criteria_to<=this.state.criteria_from&&(r.criteria_from=r.criteria_to-1)),t?this.getHourlySummary(r.criteria_product||this.state.criteria_product,r.criteria_environment||this.state.criteria_environment,r.criteria_version||this.state.criteria_version):this.hourlySummaryNeedsCanvasRender=!0,this.setState(r)},getHourlySummary:function(e,r,t){$.ajax({context:this,type:"GET",headers:{Authorization:"Bearer "+app.getAccessToken()},url:app.HOST_NAME+"/api/hourlysummary?product="+encodeURIComponent(e)+"&environment="+encodeURIComponent(r)+"&version="+encodeURIComponent(t)+"&date="}).done(function(e){var r=[],t=[],o=null,i=null;if(e.timesOccurred.length>0){var a=0;e.timesOccurred.length>36&&(a=e.timesOccurred.length-36);for(var u=0;u<e.timesOccurred.length;u++)u===a&&(o={value:u,label:this.localizeLabel(e.timesOccurred[u].key)}),0===u?r.push({value:u,label:this.localizeLabel(e.timesOccurred[u].key)}):u===e.timesOccurred.length-1?(i={value:u,label:this.localizeLabel(e.timesOccurred[u].key)},t.push(i)):(r.push({value:u,label:this.localizeLabel(e.timesOccurred[u].key)}),t.push({value:u,label:this.localizeLabel(e.timesOccurred[u].key)}))}if(0===t.length){var s=this.globalizeLabel(o.label),h=s.split(" ")[0].replace("/","-").replace("/","-"),n=s.split(" ")[1];this.getErrorSummary(this.state.criteria_product,this.state.criteria_environment,this.state.criteria_version,h,n)}else this.hourlySummaryNeedsCanvasRender=!0;this.setState({hourlySummaryResult:e,fromOptions:r,toOptions:t,criteria_from:o.value,criteria_to:i?i.value:null})}).fail(function(e,r){toastr.error(e.responseText||r,"System Error")})},paintChart_HourlySummary:function(){for(var e=[],r=[],t=[],o=[],i=this.state.hourlySummaryResult,a=parseInt(this.state.criteria_from);a<=parseInt(this.state.criteria_to);a++)e.push(this.localizeLabel(i.timesOccurred[a].key)),r.push(i.timesOccurred[a].value),t.push(i.procsAffected[a].value),o.push(i.usersAffected[a].value);var i={labels:e,datasets:[{label:"Total errors",fillColor:"rgba(200,200,200,0.2)",strokeColor:"rgba(200,200,200,1)",pointColor:"rgba(200,200,200,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(200,200,200,1)",data:r},{label:"Procedures affected",fillColor:"rgba(151,205,187,0.2)",strokeColor:"rgba(151,205,187,1)",pointColor:"rgba(151,205,187,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,205,187,1)",data:t},{label:"Users affected",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:o}]};$("#myLineChart").remove(),$("#myLineChartContainer").append('<canvas id="myLineChart" height="400" width="979"><canvas>');var u=$("#myLineChart").get(0).getContext("2d"),s=new Chart(u).Line(i,{scaleFontColor:"rgb(100,100,100)",scaleLineColor:"rgba(60,60,60,0.4)",scaleShowGridLines:!0,scaleGridLineColor:"rgba(80,80,80,.1)",scaleGridLineWidth:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="badge" style="margin-right: 5px; background-color:<%=datasets[i].strokeColor%>">•</span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'});this.myLineChart=s,$("#myLineChart").click(this.handleLineChartLabelClick),$("#myLineChartLegend").empty(),$("#myLineChartLegend").append(s.generateLegend())},getErrorSummary:function(e,r,t,o,i){$.ajax({context:this,type:"GET",headers:{Authorization:"Bearer "+app.getAccessToken()},url:app.HOST_NAME+"/api/errorsummary?product="+encodeURIComponent(e)+"&environment="+encodeURIComponent(r)+"&version="+encodeURIComponent(t)+"&date="+o+"&hour="+i+"&objectName="}).done(function(e){this.errorSummaryNeedsCanvasRender=!0,this.setState({errorSummaryResult:e})})},paintChart_ErrorSummary:function(){for(var e=this.state.errorSummaryResult,r=[],t=["rgb(247, 70, 74)","rgb(70, 191, 189)","rgb(253, 180, 92)","rgb(121,157,205)","rgb(135, 76, 194)"],o=["rgba(247, 70, 74, 0.7)","rgba(70, 191, 189, 0.7)","rgba(253, 180, 92, 0.7)","rgba(121,157,205,0.7)","rgba(135, 76, 194,0.7)"],i=0;i<e.timesOccurred.length;i++)r.length>4?(r[4].value=r[4].value+e.timesOccurred[i].value,r[4].label=r[4].label+", "+e.timesOccurred[i].key):r.push({value:e.timesOccurred[i].value,color:t[i],highlight:o[i],label:e.timesOccurred[i].key});$("#myPieChart").remove(),$("#myPieChartContainer").append('<canvas id="myPieChart" height="300" width="800"><canvas>');var a=$("#myPieChart").get(0).getContext("2d"),u=new Chart(a).Pie(r,{segmentShowStroke:!0,segmentStrokeColor:"rgb(70,70,70)",segmentStrokeWidth:2,legendTemplate:'<table style="width: 370px" class="<%=name.toLowerCase()%>-legend"><tbody><% for (var i=0; i<segments.length; i++){%><tr><td><span class="badge" style="background-color:<%=segments[i].fillColor%>"><%=segments[i].value%></span></td><td style="padding-left: 5px;"><%if(segments[i].label){%><%=segments[i].label%><%}%></td></tr><%}%></tbody></table>'});$("#myPieChartLegend").empty(),$("#myPieChartLegend").append(u.generateLegend()),$("#errorSummaryTableBody").empty();for(var s=0;s<e.details.length;s++)$("#errorSummaryTableBody").append('<tr><td class="text-right"><a href="javascript:;" onclick="app.popUpErrorHistory(\''+e.details[s].errorType+"',null,null)\">"+e.details[s].errorType+"</a></td><td>"+e.details[s].errorDescription+'</td><td><a href="javascript:;" onclick="app.popUpErrorHistory(null,\''+e.details[s].objectName+"',null)\">"+e.details[s].objectName+'</a></td><td><a href="javascript:;" onclick="app.popUpErrorHistory(null,\''+e.details[s].objectName+"','"+e.details[s].subName+"')\">"+e.details[s].subName+'</td><td class="text-center">'+e.details[s].timesOccurred+'</td><td class="text-right">'+e.details[s].latestOccurrence+'</td><td class="text-center">'+e.details[s].usersAffected+"</td></tr>")},getOptions:function(){$.ajax({context:this,type:"GET",headers:{Authorization:"Bearer "+app.getAccessToken()},url:app.HOST_NAME+"/api/options"}).done(function(e){var r=null,t=null,o=null;if(e&&e.length>0){var r=this.getProducts(e)[0],t=this.getEnvironments(e,r)[0],o=this.getVersions(e,r,t)[0];this.getHourlySummary(r,t,o)}this.setState({options:e,criteria_product:r,criteria_environment:t,criteria_version:o})})},getProducts:function(e){for(var r=[],t=0;t<e.length;t++)-1===r.indexOf(e[t].product)&&r.push(e[t].product);return r},getEnvironments:function(e,r){for(var t=[],o=0;o<e.length;o++)e[o].product===r&&-1===t.indexOf(e[o].environment)&&t.push(e[o].environment);return t},getVersions:function(e,r,t){for(var o=[],i=0;i<e.length;i++)e[i].product===r&&e[i].environment===t&&-1===o.indexOf(e[i].version)&&o.push(e[i].version);return o.reverse(),o},handleLineChartLabelClick:function(e){var r=this.myLineChart.getPointsAtEvent(e);if(0!==r.length){var t=this.globalizeLabel(r[0].label);this.lastDateClicked=t.split(" ")[0].replace("/","-").replace("/","-"),this.lastHourClicked=t.split(" ")[1],this.getErrorSummary(this.state.criteria_product,this.state.criteria_environment,this.state.criteria_version,this.lastDateClicked,this.lastHourClicked)}},popupErrorDetails:function(e,r,t){$.ajax({context:this,type:"GET",headers:{Authorization:"Bearer "+app.getAccessToken()},url:app.HOST_NAME+"/api/errorhistory?environment="+encodeURIComponent(this.state.criteria_environment)+"&version=&errorType="+e+"&objectName="+r+"&subName="+t+"&userId="}).done(function(e){this.refs.errorHistoryModal.open(e)})},pollNeedsRefresh:function(){$.ajax({context:this,type:"GET",headers:{Authorization:"Bearer "+app.getAccessToken()},url:app.HOST_NAME+"/api/needsrefresh?product="+encodeURIComponent(this.state.criteria_product)+"&environment="+encodeURIComponent(this.state.criteria_environment)+"&version="+encodeURIComponent(this.state.criteria_version)+"&date="+this.state.hourlySummaryResult.latestPoll}).done(function(e){e&&this.getHourlySummary(this.state.criteria_product,this.state.criteria_environment,this.state.criteria_version)})}});